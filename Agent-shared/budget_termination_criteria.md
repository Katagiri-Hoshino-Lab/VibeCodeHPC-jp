# 予算基準によるプロジェクト終了条件

## 概要
プロジェクトの終了判断をPMの主観ではなく、スパコン予算（計算ポイント）の消費状況に基づいて客観的に行う。

## 終了条件の定義

### 1. ハードリミット（強制終了）
- **条件**: 割り当て予算の95%を消費
- **アクション**: 全エージェント即座に終了手続き開始

### 2. ソフトリミット（警告→段階的終了）
- **80%消費時**: 新規最適化の停止、既存ジョブの完了待ち
- **85%消費時**: PGの新規コード生成停止
- **90%消費時**: 実行中ジョブの早期終了検討

### 3. 効率基準による早期終了
- **条件**: 直近10回の試行で性能向上が1%未満
- **かつ**: 予算を50%以上消費
- **アクション**: PMに終了提案

## 予算追跡方法

### budget_history.mdの記録形式
```markdown
## 2025-01-30T12:00:00Z
- used: 12,345 ポイント
- 本プロジェクト消費: 1,234 ポイント
- 消費率: 61.7%（割り当て2,000ポイントに対して）
- 推定残り時間: 2.5時間（現在の消費ペース）
```

### 監視コマンド（スパコン依存）
- 不老: `pjstat`
- 富岳: `fjstat`
- その他: `_remote_info/command.md`参照

## エージェント別の対応

### PM
- 5分ごとに予算状況を確認
- 閾値到達時に全エージェントへ通知
- リソース再配分の最終決定権

### SE
- 予算効率（ポイント/性能向上）を計算
- 非効率なPGの特定と報告

### PG
- ジョブ投入前に残予算確認
- 予算超過リスクがある長時間ジョブは事前相談

### CD
- 予算状況に関わらずSOTAコードの保全を優先

## 予算枯渇時の緊急手順

1. **即座に実行**
   - 全実行中ジョブの`scancel`/`qdel`
   - SSH/SFTPセッションの終了
   - 最新SOTAコードのGitHub push

2. **5分以内に完了**
   - 各エージェントの最終ChangeLog.md更新
   - final_report.mdの生成
   - 成果物の整理

3. **クリーンアップ**
   - スパコン側の大容量ファイル削除（任意）
   - ローカル一時ファイルの削除

## 注意事項
- ログインノードでの実行は予算消費しないが、**禁止**
- ポイント消費がない場合、PMは即座に警告を発する
- 予算情報は個人情報のため、具体的な残額は記載しない